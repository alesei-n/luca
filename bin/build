#!/usr/bin/env ruby

require 'rubygems'
require 'bundler'

Bundler.require

ROOT = File.join( File.dirname(__FILE__), '..') 
SOURCE_DIR = File.join( ROOT, 'src' )
JAVASCRIPT = File.join( ROOT, 'lib', 'luca.js' )
CSS = File.join( ROOT, 'lib', 'luca.css' )

# examples
EXAMPLES_DIR = File.join( ROOT, 'examples' )
JAVASCRIPT_EXAMPLES = File.join( ROOT, 'examples', 'javascripts' )
CSS_EXAMPLES = File.join( ROOT, 'examples', 'stylesheets' )

sprockets = Sprockets::Environment.new( ROOT ) do |env|

end

sprockets.append_path( File.join(SOURCE_DIR, 'coffeescripts') )
sprockets.append_path( File.join(SOURCE_DIR, 'stylesheets') )

File.open( JAVASCRIPT, 'w+') do |fh|
  fh.puts sprockets['build.js'].to_s
end

File.open( CSS, 'w+') do |fh|
  fh.puts sprockets['build.css'].to_s
end

FileUtils.cp JAVASCRIPT, JAVASCRIPT_EXAMPLES
FileUtils.cp CSS, CSS_EXAMPLES

File.open( File.join(ROOT,'examples','javascripts','examples.js'), 'w+' ) do |fh|
  fh.puts sprockets['examples.coffee'].to_s
end


